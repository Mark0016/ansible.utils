---
- name: Set fact
  ansible.builtin.set_fact:
    ios_cli_parse_text_parsed: "{{ lookup('ansible.builtin.file', '{{ role_path }}/output/ios_show_version_parsed.json') | from_json }}"

- name: "Pass text and template_path {{ parser }}"
  ansible.utils.cli_parse:
    text: "{{ lookup('ansible.builtin.file', '{{ role_path }}/files/ios_show_version.txt') }}"
    parser:
      name: ansible.netcommon.native
      template_path: "templates/ios_show_version.yaml"
  register: ios_custom_cli_parse

- name: "Confirm response {{ parser }}"
  ansible.builtin.assert:
    that: "{{ item }}"
  with_items:
    - "{{ ios_custom_cli_parse['parsed']['version'] == ios_cli_parse_text_parsed['Cisco_IOS_XE_Software_Version'] }}"